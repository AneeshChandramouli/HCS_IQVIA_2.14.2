PROC SQL;
   CREATE TABLE POPEST AS 
   SELECT DISTINCT 
		  t1.COUNTY,
		  T1.YEAR,
		  T1.REPORTERID,
		  CASE WHEN T1.YEAR=2017 AND T1.ReporterId IN ('0371', '0372', '0373') AND T1.POP=. THEN T2.POP
		       ELSE T1.POP END AS POP
      FROM WONDER.POPEST AS T1 LEFT JOIN WONDER.POPEST(WHERE=(YEAR=2018 AND ReporterId IN ('0371', '0372', '0373'))) AS T2 ON 
	           T1.COUNTY=T2.COUNTY
	  ORDER BY t1.COUNTY,
		       t1.YEAR
;
QUIT;

